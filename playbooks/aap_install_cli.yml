---
- name: Install automation controller cli package
  hosts: "{{ bastion | default('all') }}"
  become: false
  gather_facts: true
  tasks:
    - name: Gather package facts
      package_facts:

    - name: Install automation controller cli package
      vars:
        installer_repo: >-
          ansible-automation-platform-{{ aap_install_version -}}
          -for-rhel-{{ ansible_facts.distribution_major_version -}}
          -{{ ansible_facts.architecture }}-rpms
      become: true
      yum:
        name: automation-controller-cli
        enablerepo: "{{ installer_repo }}"
        state: present
      when: "'automation-controller-cli' not in ansible_facts.packages"
